<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finamax - Quiz de Empréstimos</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#820AD1',
                        'primary-hover': '#9434d4', // Tom mais claro para hover
                        secondary: '#1A202C',     // Cinza chumbo para textos
                        success: '#34D399',       // Verde menta
                        'success-dark': '#059669',    // Verde mais escuro para hover
                        'success-light': '#A7F3D0',  // Fundo do ícone de sucesso
                        danger: '#EF4444',        // Vermelho para erros
                        'light-bg': '#F7FAFC',      // Fundo da página
                    }
                }
            }
        }
    </script>
    <style>
        .progress-bar {
            height: 8px;
            transition: width 0.5s ease;
        }
        
        .fade-in {
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(26, 32, 44, 0.2);
            border-radius: 50%;
            border-top-color: #1A202C;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="font-sans bg-light-bg">
    <div class="min-h-screen flex flex-col">
        <!-- Progress Bar -->
        <div class="bg-gray-200 h-2 w-full">
            <div id="progressBar" class="progress-bar bg-primary" style="width: 0%"></div>
        </div>
        
        <!-- Header -->
        <header class="bg-white shadow-sm py-4">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center">
                    <div class="flex items-center">
                        <div class="bg-primary text-white font-bold rounded-lg p-2 mr-3">
                            <span class="text-xl">F</span>
                        </div>
                        <h1 class="text-xl font-bold text-secondary">Finamax</h1>
                    </div>
                    <div class="hidden md:block">
                        <span class="text-gray-600"><i class="fas fa-phone-alt mr-2 text-primary"></i>0800 123 4567</span>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-4 py-8">
            <!-- Quiz Container -->
            <div id="quizContainer" class="max-w-2xl mx-auto bg-white rounded-xl shadow-md overflow-hidden fade-in">
                <!-- Step 0: Welcome -->
                <div id="step0" class="p-8">
                    <div class="text-center mb-8">
                        <h2 class="text-2xl md:text-3xl font-bold text-secondary mb-2">DESCOMPLICAMOS O EMPRÉSTIMO</h2>
                        <p class="text-gray-600">Faça a simulação grátis e descubra seu limite pré-aprovado agora mesmo.</p>
                    </div>
                    
                    <div class="grid md:grid-cols-3 gap-6 mb-8">
                        <div class="text-center p-4 rounded-lg border border-gray-200">
                            <div class="text-primary text-3xl mb-3"><i class="fas fa-bolt"></i></div>
                            <h3 class="font-bold text-secondary mb-2">Aprovação rápida</h3>
                            <p class="text-gray-600 text-sm">Resposta em poucos minutos</p>
                        </div>
                        <div class="text-center p-4 rounded-lg border border-gray-200">
                            <div class="text-primary text-3xl mb-3"><i class="fas fa-percentage"></i></div>
                            <h3 class="font-bold text-secondary mb-2">Taxas acessíveis</h3>
                            <p class="text-gray-600 text-sm">As melhores condições do mercado</p>
                        </div>
                        <div class="text-center p-4 rounded-lg border border-gray-200">
                            <div class="text-primary text-3xl mb-3"><i class="fas fa-headset"></i></div>
                            <h3 class="font-bold text-secondary mb-2">Atendimento especializado</h3>
                            <p class="text-gray-600 text-sm">Consultores prontos para ajudar</p>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="nextStep()" class="bg-primary hover:bg-primary-hover text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300 transform hover:scale-105">
                            Começar agora <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 1: Nome Completo -->
                <div id="step1" class="hidden p-8">
                    <div class="mb-6">
                        <div class="flex items-center mb-2">
                            <span class="bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center mr-2">1</span>
                            <h2 class="text-xl font-bold text-secondary">Qual é o seu nome completo?</h2>
                        </div>
                        <p class="text-gray-600 ml-10 mb-4">Precisamos do seu nome completo para verificar sua identidade.</p>
                    </div>
                    
                    <div class="ml-10 mb-6">
                        <input type="text" id="nomeCompleto" class="w-full px-4 py-3 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="Digite seu nome completo">
                    </div>
                    
                    <div class="ml-10 mb-6">
                        <div id="feedback1" class="hidden bg-gray-100 text-secondary p-3 rounded-lg flex items-center">
                            <i class="fas fa-check-circle text-success mr-2"></i>
                            <span>+10% de chance de aprovação</span>
                        </div>
                    </div>
                    
                    <div class="ml-10 text-right">
                        <button onclick="nextStep()" class="bg-primary hover:bg-primary-hover text-white font-bold py-3 px-6 rounded-lg transition duration-300 disabled:opacity-50" disabled id="btnStep1">
                            Próxima pergunta <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 2: CPF -->
                <div id="step2" class="hidden p-8">
                    <div class="mb-6">
                        <div class="flex items-center mb-2">
                            <span class="bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center mr-2">2</span>
                            <h2 class="text-xl font-bold text-secondary">Qual é o seu CPF?</h2>
                        </div>
                        <p class="text-gray-600 ml-10 mb-4">Seu CPF é necessário para consulta de crédito.</p>
                    </div>
                    
                    <div class="ml-10 mb-6">
                        <input type="text" id="cpf" class="w-full px-4 py-3 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="Digite seu CPF">
                    </div>
                    <div class="ml-10 text-center text-xs text-gray-500 mb-6">
                        <i class="fas fa-lock mr-1"></i> Seus dados estão 100% seguros e protegidos.
                    </div>
                    <p id="cpfError" class="text-danger text-center text-sm my-4 hidden ml-10"><i class="fas fa-exclamation-circle mr-1"></i> CPF inválido. Por favor, verifique os dígitos.</p>
                    
                    <div class="ml-10 mb-6">
                        <div id="feedback2" class="hidden bg-gray-100 text-secondary p-3 rounded-lg flex items-center">
                            <i class="fas fa-check-circle text-success mr-2"></i>
                            <span>+25% de chance de aprovação</span>
                        </div>
                    </div>
                    
                    <div class="ml-10 flex justify-end">
                        <button onclick="nextStep()" class="bg-primary hover:bg-primary-hover text-white font-bold py-3 px-6 rounded-lg transition duration-300 disabled:opacity-50" disabled id="btnStep2">
                            Próxima pergunta <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 3: Telefone -->
                <div id="step3" class="hidden p-8">
                    <div class="mb-6">
                        <div class="flex items-center mb-2">
                            <span class="bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center mr-2">3</span>
                            <h2 class="text-xl font-bold text-secondary">Qual é o seu telefone?</h2>
                        </div>
                        <p class="text-gray-600 ml-10 mb-4">Precisamos do seu telefone para entrar em contato.</p>
                    </div>
                    
                    <div class="ml-10 mb-6">
                        <input type="text" id="telefone" class="w-full px-4 py-3 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="Digite seu telefone com DDD">
                    </div>
                    
                    <div class="ml-10 mb-6">
                        <div id="feedback3" class="hidden bg-gray-100 text-secondary p-3 rounded-lg flex items-center">
                            <i class="fas fa-check-circle text-success mr-2"></i>
                            <span>+40% de chance de aprovação</span>
                        </div>
                    </div>
                    
                    <div class="ml-10 flex justify-end">
                        <button onclick="nextStep()" class="bg-primary hover:bg-primary-hover text-white font-bold py-3 px-6 rounded-lg transition duration-300 disabled:opacity-50" disabled id="btnStep3">
                            Próxima pergunta <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 4: Valor Desejado -->
                <div id="step4" class="hidden p-8">
                    <div class="mb-6">
                        <div class="flex items-center mb-2">
                            <span class="bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center mr-2">4</span>
                            <h2 class="text-xl font-bold text-secondary">Qual valor você deseja?</h2>
                        </div>
                        <p class="text-gray-600 ml-10 mb-4">Selecione o valor que melhor atende suas necessidades.</p>
                    </div>
                    
                    <div class="ml-10 mb-6 grid grid-cols-2 gap-4">
                        <button onclick="selectValue(5000)" class="value-btn bg-white hover:bg-gray-100 border border-gray-300 text-gray-800 font-bold py-4 px-4 rounded-lg transition duration-300">
                            R$ 5.000
                        </button>
                        <button onclick="selectValue(10000)" class="value-btn bg-white hover:bg-gray-100 border border-gray-300 text-gray-800 font-bold py-4 px-4 rounded-lg transition duration-300">
                            R$ 10.000
                        </button>
                        <button onclick="selectValue(20000)" class="value-btn bg-white hover:bg-gray-100 border border-gray-300 text-gray-800 font-bold py-4 px-4 rounded-lg transition duration-300">
                            R$ 20.000
                        </button>
                        <button onclick="selectValue(30000)" class="value-btn bg-white hover:bg-gray-100 border border-gray-300 text-gray-800 font-bold py-4 px-4 rounded-lg transition duration-300">
                            R$ 30.000
                        </button>
                        <button onclick="selectValue(50000)" class="value-btn bg-white hover:bg-gray-100 border border-gray-300 text-gray-800 font-bold py-4 px-4 rounded-lg transition duration-300">
                            R$ 50.000
                        </button>
                        <button onclick="showCustomValue()" class="value-btn bg-white hover:bg-gray-100 border border-gray-300 text-gray-800 font-bold py-4 px-4 rounded-lg transition duration-300">
                            Outro valor
                        </button>
                    </div>
                    
                    <div id="customValueContainer" class="ml-10 mb-6 hidden">
                        <input type="number" id="customValue" max="100000" class="w-full px-4 py-3 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="Digite o valor desejado">
                        <p class="text-xs text-gray-500 mt-2">O valor máximo é de R$ 100.000.</p>
                    </div>
                    
                    <div class="ml-10 mb-6">
                        <div id="feedback4" class="hidden bg-gray-100 text-secondary p-3 rounded-lg flex items-center">
                            <i class="fas fa-check-circle text-success mr-2"></i>
                            <span>+70% de chance de aprovação</span>
                        </div>
                    </div>
                     <p id="submitError" class="text-danger text-center text-sm my-4 hidden ml-10"><i class="fas fa-exclamation-circle mr-1"></i></p>
                    
                    <div class="ml-10 flex justify-end">
                        <button onclick="submitQuiz()" class="bg-primary hover:bg-primary-hover text-white font-bold py-3 px-6 rounded-lg transition duration-300 disabled:opacity-50" disabled id="btnStep4">
                            Finalizar <i class="fas fa-check ml-2"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 5: Loading -->
                <div id="step5" class="hidden p-8">
                    <div class="text-center py-12">
                        <div class="loading-spinner mx-auto mb-8"></div>
                        <h2 class="text-2xl font-bold text-secondary mb-4">Estamos analisando sua solicitação...</h2>
                        <p class="text-gray-600">Aguarde alguns instantes enquanto verificamos as melhores opções para você.</p>
                    </div>
                </div>
                
                <!-- Step 6: Result -->
                <div id="step6" class="hidden p-8">
                    <div class="text-center py-8">
                        <div class="bg-success-light text-success rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-check-circle text-4xl"></i>
                        </div>
                        <h2 id="greetingMessage" class="text-3xl font-bold text-secondary mb-4">Parabéns!</h2>
                        <p class="text-xl text-gray-700 mb-6">Sua análise foi concluída com sucesso.</p>
                        
                        <div class="bg-gray-100 rounded-xl p-6 max-w-md mx-auto mb-8">
                            <p class="text-gray-600 mb-2">Valor pré-aprovado:</p>
                            <p class="text-3xl font-bold text-secondary mb-4" id="approvedValue">R$ 0,00</p>
                            <div class="w-full bg-gray-200 rounded-full h-4">
                                <div class="bg-success h-4 rounded-full" style="width: 95%"></div>
                            </div>
                            <p class="text-gray-600 mt-2">Sua chance de aprovação está em <span class="font-bold">95%</span></p>
                        </div>
                        
                        <a id="whatsappBtn" href="#" class="inline-block bg-success hover:bg-success-dark text-white font-bold py-4 px-8 rounded-full text-lg transition duration-300 transform hover:scale-105 pulse">
                            <i class="fab fa-whatsapp mr-2"></i> Falar agora com um consultor especialista
                        </a>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="bg-secondary text-white py-8">
            <div class="container mx-auto px-4">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0 text-center md:text-left">
                        <div class="flex items-center justify-center md:justify-start">
                            <div class="bg-white text-primary font-bold rounded-lg p-2 mr-3">
                                <span class="text-xl">F</span>
                            </div>
                            <h3 class="text-xl font-bold">Finamax</h3>
                        </div>
                        <p class="text-sm opacity-80 mt-2">Soluções financeiras inteligentes</p>
                    </div>
                    <div class="text-xs opacity-80 text-center md:text-right space-y-1 mt-4 md:mt-0">
                        <p>Copyright © 2024 Todos os Direitos Reservados</p>
                        <p>Finamax - CNPJ/MF sob o número 00.411.939/0001-49</p>
                        <p>Finamax, Crédito, Financiamento e Investimento S.A, instituição financeira de direito privado, <br class="hidden md:block"> sediada na Rua Rangel Pestana, 681, Centro, Jundiaí, estado de São Paulo, CEP 13.201-000</p>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        let currentStep = 0;
        let selectedValue = 0;
        let userData = {
            nome: '',
            cpf: '',
            telefone: '',
            valor: 0
        };

        const SCRIPT_URL = ''; // <-- COLOQUE A URL DO SEU SCRIPT DO GOOGLE SHEETS AQUI

        function testaCPF(strCPF) {
            let Soma;
            let Resto;
            Soma = 0;
            if (strCPF == "00000000000") return false;

            for (i=1; i<=9; i++) Soma = Soma + parseInt(strCPF.substring(i-1, i)) * (11 - i);
            Resto = (Soma * 10) % 11;

            if ((Resto == 10) || (Resto == 11))  Resto = 0;
            if (Resto != parseInt(strCPF.substring(9, 10)) ) return false;

            Soma = 0;
            for (i = 1; i <= 10; i++) Soma = Soma + parseInt(strCPF.substring(i-1, i)) * (12 - i);
            Resto = (Soma * 10) % 11;

            if ((Resto == 10) || (Resto == 11))  Resto = 0;
            if (Resto != parseInt(strCPF.substring(10, 11) ) ) return false;
            return true;
        }
        
        $(document).ready(function() {
            $('#cpf').mask('000.000.000-00', {reverse: true});
            $('#telefone').mask('(00) 00000-0000');
            
            $('#nomeCompleto').on('input', validateStep1);
            $('#cpf').on('input', validateStep2);
            $('#telefone').on('input', validateStep3);
            $('#customValue').on('input', validateStep4);
        });
        
        function nextStep() {
            if (currentStep === 1) {
                userData.nome = $('#nomeCompleto').val();
                $('#feedback1').removeClass('hidden');
            } else if (currentStep === 2) {
                const cpfRaw = $('#cpf').val().replace(/\D/g, '');
                if (!testaCPF(cpfRaw)) {
                    $('#cpfError').removeClass('hidden');
                    return;
                }
                $('#cpfError').addClass('hidden');
                userData.cpf = $('#cpf').val();
                $('#feedback2').removeClass('hidden');
            } else if (currentStep === 3) {
                userData.telefone = $('#telefone').val();
                $('#feedback3').removeClass('hidden');
            }
            
            $(`#step${currentStep}`).addClass('hidden');
            currentStep++;
            $(`#step${currentStep}`).removeClass('hidden').addClass('fade-in');
            
            updateProgressBar();
        }
        
        function updateProgressBar() {
            const progress = (currentStep / 4) * 100;
            $('#progressBar').css('width', `${progress}%`);
        }
        
        function validateStep1() {
            const nome = $('#nomeCompleto').val();
            const isValid = nome.trim().split(' ').length >= 2 && nome.length > 5;
            $('#btnStep1').prop('disabled', !isValid);
        }
        
        function validateStep2() {
            const cpf = $('#cpf').val();
            const isValid = cpf.replace(/\D/g, '').length === 11;
            $('#btnStep2').prop('disabled', !isValid);
             if (isValid) {
                if (!testaCPF(cpf.replace(/\D/g, ''))) {
                    $('#cpfError').removeClass('hidden');
                    $('#btnStep2').prop('disabled', true);
                } else {
                    $('#cpfError').addClass('hidden');
                }
            } else {
                $('#cpfError').addClass('hidden');
            }
        }
        
        function validateStep3() {
            const telefone = $('#telefone').val();
            const isValid = telefone.replace(/\D/g, '').length === 11;
            $('#btnStep3').prop('disabled', !isValid);
        }
        
        function validateStep4() {
            const customValue = $('#customValue').val();
            const isValid = customValue > 0 && customValue <= 100000;
            $('#btnStep4').prop('disabled', !isValid);
            
            if (isValid) {
                selectedValue = parseFloat(customValue);
                 $('#feedback4').removeClass('hidden');
            } else {
                 $('#feedback4').addClass('hidden');
            }
        }
        
        function selectValue(value) {
            selectedValue = value;
            $('#btnStep4').prop('disabled', false);
            $('#feedback4').removeClass('hidden');
            
            $('.value-btn').removeClass('bg-primary text-white border-primary').addClass('bg-white text-gray-800 border-gray-300');
            $(event.target).removeClass('bg-white text-gray-800 border-gray-300').addClass('bg-primary text-white border-primary');
            $('#customValueContainer').addClass('hidden');
             $('#customValue').val('');
        }
        
        function showCustomValue() {
            $('#customValueContainer').removeClass('hidden').find('input').focus();
            $('.value-btn').removeClass('bg-primary text-white border-primary').addClass('bg-white text-gray-800 border-gray-300');
            $(event.target).addClass('bg-primary text-white border-primary');
            $('#btnStep4').prop('disabled', true);
            $('#feedback4').addClass('hidden');
            selectedValue = 0;
        }
        
        async function submitQuiz() {
            userData.valor = selectedValue;
            $('#btnStep4').prop('disabled', true).html('<div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mx-auto"></div>');
            
            if (!SCRIPT_URL) {
                console.warn("URL do Google Script não configurada. Simulando envio bem-sucedido.");
                setTimeout(() => {
                    $(`#step${currentStep}`).addClass('hidden');
                    currentStep++;
                    $(`#step${currentStep}`).removeClass('hidden').addClass('fade-in');
                    setTimeout(showResult, 10000);
                }, 1000);
                return;
            }

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', 
                    cache: 'no-cache',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(userData),
                });
                
                // Como 'no-cors' não permite ler a resposta, assumimos sucesso.
                // A validação de duplicidade será feita no Google Script.
                // Para saber se houve erro, você precisaria de uma API mais robusta.
                // A lógica para verificar a resposta do script (se não fosse 'no-cors') seria algo como:
                /*
                const result = await response.json();
                if(result.status === 'duplicate'){
                     $('#submitError').text('Este CPF já foi cadastrado.').removeClass('hidden');
                     $('#btnStep4').prop('disabled', false).html('Finalizar <i class="fas fa-check ml-2"></i>');
                     return;
                }
                */

                $(`#step${currentStep}`).addClass('hidden');
                currentStep++;
                $(`#step${currentStep}`).removeClass('hidden').addClass('fade-in');
                setTimeout(showResult, 10000);

            } catch (error) {
                console.error('Error:', error);
                $('#submitError').text('Ocorreu um erro ao enviar. Tente novamente.').removeClass('hidden');
                $('#btnStep4').prop('disabled', false).html('Finalizar <i class="fas fa-check ml-2"></i>');
            }
        }
        
        function showResult() {
            $(`#step5`).addClass('hidden');
            currentStep = 6;
            $(`#step6`).removeClass('hidden').addClass('fade-in');
            
            // Extrai o primeiro nome para personalização
            const firstName = userData.nome.split(' ')[0];
            $('#greetingMessage').html(`Parabéns, ${firstName}!`);
            
            const randomFactor = 0.9 + Math.random() * 0.1; 
            const approvedValue = userData.valor * randomFactor;
            
            const formattedValue = approvedValue.toLocaleString('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            });
            
            $('#approvedValue').text(formattedValue);
            
            const whatsappMessage = encodeURIComponent(`Olá, sou ${userData.nome} e o valor pré-aprovado no site foi de ${formattedValue}. Desejo dar continuidade no contrato.`);
            const whatsappNumber = "5573991927672"; // Substitua pelo seu número
            $('#whatsappBtn').attr('href', `https://wa.me/${whatsappNumber}?text=${whatsappMessage}`);
        }
    </script>
</body>
</html>

